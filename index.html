<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!doctype html&gt;</p>
<p class="p1">&lt;html lang="en"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;meta charset="utf-8" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;meta name="viewport" content="width=device-width,initial-scale=1" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;title&gt;Bin Day&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;meta name="theme-color" content="#0b1220" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>:root { color-scheme: light dark; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>body { font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; margin: 0; padding: 24px; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.wrap { max-width: 560px; margin: 0 auto; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.card { border: 1px solid rgba(127,127,127,.25); border-radius: 18px; padding: 18px; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>h1 { margin: 0 0 10px; font-size: 22px; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.muted { opacity: .7; font-size: 14px; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.big { font-size: 22px; margin: 12px 0 6px; font-weight: 700; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.pill { display: inline-flex; align-items: center; gap: 8px; padding: 8px 12px; border-radius: 999px; border: 1px solid rgba(127,127,127,.25); }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.binDot { width: 12px; height: 12px; border-radius: 50%; display: inline-block; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.row { display: flex; gap: 12px; flex-wrap: wrap; margin-top: 14px; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>button { border-radius: 12px; padding: 10px 12px; border: 1px solid rgba(127,127,127,.35); background: transparent; font: inherit; cursor: pointer; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>button:active { transform: translateY(1px); }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.footer { margin-top: 14px; }</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;body&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;div class="wrap"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="card"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;h1&gt;Bin Day&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="muted" id="today"&gt;&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="big" id="nextLine"&gt;Loading…&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="muted" id="note" style="margin-top:4px;"&gt;&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="pill" id="binPill" style="display:none; margin-top:12px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;span class="binDot" id="binDot"&gt;&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;span id="binName"&gt;&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button id="addCal"&gt;Add reminder to calendar&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button id="copy"&gt;Copy next bin info&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="footer muted"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>Tip: on iPhone, open in Safari → Share → &lt;b&gt;Add to Home Screen&lt;/b&gt;.</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>// ====== CONFIG ======</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>// Rotation for your block (Garden included because you pay)</p>
<p class="p1"><span class="Apple-converted-space">  </span>const rotation = ["Garden Waste", "Paper &amp; Card", "Mixed Recycling", "General Waste"];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>// Anchor taken from your card: Thu 5 Feb 2026 = Paper &amp; Card (purple)</p>
<p class="p1"><span class="Apple-converted-space">  </span>// (JS months are 0-indexed, so Feb = 1)</p>
<p class="p1"><span class="Apple-converted-space">  </span>const anchorDate = new Date(2026, 1, 5, 12, 0, 0);</p>
<p class="p1"><span class="Apple-converted-space">  </span>const anchorIndex = 1;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>// Colour mapping matching the legend</p>
<p class="p1"><span class="Apple-converted-space">  </span>const binColours = {</p>
<p class="p1"><span class="Apple-converted-space">    </span>"Garden Waste": "#2e7d32",</p>
<p class="p1"><span class="Apple-converted-space">    </span>"Paper &amp; Card": "#7b1fa2",</p>
<p class="p1"><span class="Apple-converted-space">    </span>"Mixed Recycling": "#1565c0",</p>
<p class="p1"><span class="Apple-converted-space">    </span>"General Waste": "#111111"</p>
<p class="p1"><span class="Apple-converted-space">  </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>// Special-date overrides (from your December changes)</p>
<p class="p1"><span class="Apple-converted-space">  </span>// - Thu 24 Dec 2026: no collection</p>
<p class="p1"><span class="Apple-converted-space">  </span>// - Wed 23 Dec 2026: General Waste</p>
<p class="p1"><span class="Apple-converted-space">  </span>// - Thu 31 Dec 2026: Paper &amp; Card</p>
<p class="p1"><span class="Apple-converted-space">  </span>const overrides = {</p>
<p class="p1"><span class="Apple-converted-space">    </span>"2026-12-23": "General Waste",</p>
<p class="p1"><span class="Apple-converted-space">    </span>"2026-12-31": "Paper &amp; Card"</p>
<p class="p1"><span class="Apple-converted-space">  </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>// Explicit "no collection" dates (we can add more later if needed)</p>
<p class="p1"><span class="Apple-converted-space">  </span>const noCollection = new Set([</p>
<p class="p1"><span class="Apple-converted-space">    </span>"2026-12-24"</p>
<p class="p1"><span class="Apple-converted-space">  </span>]);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>// ====== HELPERS ======</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>function pad2(n){ return String(n).padStart(2,"0"); }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>function toKey(date) {</p>
<p class="p1"><span class="Apple-converted-space">    </span>// Use local date parts to avoid timezone drift</p>
<p class="p1"><span class="Apple-converted-space">    </span>return `${date.getFullYear()}-${pad2(date.getMonth()+1)}-${pad2(date.getDate())}`;</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>function formatFull(d) {</p>
<p class="p1"><span class="Apple-converted-space">    </span>return d.toLocaleDateString(undefined, { weekday:"long", year:"numeric", month:"long", day:"numeric" });</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>function atNoon(d) {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const x = new Date(d);</p>
<p class="p1"><span class="Apple-converted-space">    </span>x.setHours(12,0,0,0);</p>
<p class="p1"><span class="Apple-converted-space">    </span>return x;</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>// Find the next given weekday (0=Sun ... 6=Sat). If it's already that day, returns next week.</p>
<p class="p1"><span class="Apple-converted-space">  </span>function nextWeekday(from, weekday) {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const d = new Date(from);</p>
<p class="p1"><span class="Apple-converted-space">    </span>const day = d.getDay();</p>
<p class="p1"><span class="Apple-converted-space">    </span>let diff = (weekday - day + 7) % 7;</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (diff === 0) diff = 7;</p>
<p class="p1"><span class="Apple-converted-space">    </span>d.setDate(d.getDate() + diff);</p>
<p class="p1"><span class="Apple-converted-space">    </span>return atNoon(d);</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>// Bin for a collection date:</p>
<p class="p1"><span class="Apple-converted-space">  </span>// 1) overrides win</p>
<p class="p1"><span class="Apple-converted-space">  </span>// 2) if it's a no-collection date, return null</p>
<p class="p1"><span class="Apple-converted-space">  </span>// 3) otherwise use the normal weekly rotation (anchored)</p>
<p class="p1"><span class="Apple-converted-space">  </span>function binForDate(collectionDate) {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const key = toKey(collectionDate);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>if (overrides[key]) return overrides[key];</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (noCollection.has(key)) return null;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>const msPerWeek = 1000 * 60 * 60 * 24 * 7;</p>
<p class="p1"><span class="Apple-converted-space">    </span>const weeks = Math.floor((collectionDate - anchorDate) / msPerWeek);</p>
<p class="p1"><span class="Apple-converted-space">    </span>const idx = (anchorIndex + weeks) % rotation.length;</p>
<p class="p1"><span class="Apple-converted-space">    </span>return rotation[(idx + rotation.length) % rotation.length];</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>// Find the next actual collection date (handles Christmas moved-to-Wednesday etc.)</p>
<p class="p1"><span class="Apple-converted-space">  </span>// Strategy:</p>
<p class="p1"><span class="Apple-converted-space">  </span>// - Candidate 1: next Thursday</p>
<p class="p1"><span class="Apple-converted-space">  </span>// - If that's a no-collection date, also check Wednesday of that same week (and any override dates we know)</p>
<p class="p1"><span class="Apple-converted-space">  </span>// - More generally, scan forward day-by-day up to 14 days until we find a date with a bin.</p>
<p class="p1"><span class="Apple-converted-space">  </span>function nextCollection(from) {</p>
<p class="p1"><span class="Apple-converted-space">    </span>// Start from tomorrow (so on collection day itself, it shows the next one)</p>
<p class="p1"><span class="Apple-converted-space">    </span>const start = new Date(from);</p>
<p class="p1"><span class="Apple-converted-space">    </span>start.setHours(12,0,0,0);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// We'll scan forward up to 14 days to be safe.</p>
<p class="p1"><span class="Apple-converted-space">    </span>for (let i = 1; i &lt;= 14; i++) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const d = new Date(start);</p>
<p class="p1"><span class="Apple-converted-space">      </span>d.setDate(d.getDate() + i);</p>
<p class="p1"><span class="Apple-converted-space">      </span>d.setHours(12,0,0,0);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// We only care about weekdays likely used by the council, but scanning all days is simplest &amp; robust.</p>
<p class="p1"><span class="Apple-converted-space">      </span>const bin = binForDate(d);</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (bin) return { date: d, bin };</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>return null;</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>// Minimal .ics generator (works well on iOS/Apple Calendar/Google Calendar)</p>
<p class="p1"><span class="Apple-converted-space">  </span>function makeICS({ title, date, minutesBefore = 720 }) {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const y = date.getFullYear(), m = pad2(date.getMonth()+1), d = pad2(date.getDate());</p>
<p class="p1"><span class="Apple-converted-space">    </span>// All-day event avoids timezone pain</p>
<p class="p1"><span class="Apple-converted-space">    </span>const dtStart = `${y}${m}${d}`;</p>
<p class="p1"><span class="Apple-converted-space">    </span>const dtEndDate = new Date(date); dtEndDate.setDate(dtEndDate.getDate()+1);</p>
<p class="p1"><span class="Apple-converted-space">    </span>const y2 = dtEndDate.getFullYear(), m2 = pad2(dtEndDate.getMonth()+1), d2 = pad2(dtEndDate.getDate());</p>
<p class="p1"><span class="Apple-converted-space">    </span>const dtEnd = `${y2}${m2}${d2}`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>const now = new Date();</p>
<p class="p1"><span class="Apple-converted-space">    </span>const stamp = `${now.getUTCFullYear()}${pad2(now.getUTCMonth()+1)}${pad2(now.getUTCDate())}T${pad2(now.getUTCHours())}${pad2(now.getUTCMinutes())}${pad2(now.getUTCSeconds())}Z`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>return [</p>
<p class="p1"><span class="Apple-converted-space">      </span>"BEGIN:VCALENDAR",</p>
<p class="p1"><span class="Apple-converted-space">      </span>"VERSION:2.0",</p>
<p class="p1"><span class="Apple-converted-space">      </span>"PRODID:-//BinDay//EN",</p>
<p class="p1"><span class="Apple-converted-space">      </span>"CALSCALE:GREGORIAN",</p>
<p class="p1"><span class="Apple-converted-space">      </span>"BEGIN:VEVENT",</p>
<p class="p1"><span class="Apple-converted-space">      </span>`UID:binday-${dtStart}-${Math.random().toString(16).slice(2)}@local`,</p>
<p class="p1"><span class="Apple-converted-space">      </span>`DTSTAMP:${stamp}`,</p>
<p class="p1"><span class="Apple-converted-space">      </span>`SUMMARY:${title.replace(/\n/g," ")}`,</p>
<p class="p1"><span class="Apple-converted-space">      </span>`DTSTART;VALUE=DATE:${dtStart}`,</p>
<p class="p1"><span class="Apple-converted-space">      </span>`DTEND;VALUE=DATE:${dtEnd}`,</p>
<p class="p1"><span class="Apple-converted-space">      </span>"BEGIN:VALARM",</p>
<p class="p1"><span class="Apple-converted-space">      </span>`TRIGGER:-PT${minutesBefore}M`,</p>
<p class="p1"><span class="Apple-converted-space">      </span>"ACTION:DISPLAY",</p>
<p class="p1"><span class="Apple-converted-space">      </span>"DESCRIPTION:Bin reminder",</p>
<p class="p1"><span class="Apple-converted-space">      </span>"END:VALARM",</p>
<p class="p1"><span class="Apple-converted-space">      </span>"END:VEVENT",</p>
<p class="p1"><span class="Apple-converted-space">      </span>"END:VCALENDAR"</p>
<p class="p1"><span class="Apple-converted-space">    </span>].join("\r\n");</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>// ====== RENDER ======</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const today = new Date();</p>
<p class="p1"><span class="Apple-converted-space">  </span>document.getElementById("today").textContent = `Today: ${formatFull(today)}`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const next = nextCollection(today);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const nextLine = document.getElementById("nextLine");</p>
<p class="p1"><span class="Apple-converted-space">  </span>const note = document.getElementById("note");</p>
<p class="p1"><span class="Apple-converted-space">  </span>const pill = document.getElementById("binPill");</p>
<p class="p1"><span class="Apple-converted-space">  </span>const binName = document.getElementById("binName");</p>
<p class="p1"><span class="Apple-converted-space">  </span>const binDot = document.getElementById("binDot");</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>if (!next) {</p>
<p class="p1"><span class="Apple-converted-space">    </span>nextLine.textContent = "Couldn’t find the next collection date.";</p>
<p class="p1"><span class="Apple-converted-space">    </span>note.textContent = "If your council shifts more dates, we can add them as overrides.";</p>
<p class="p1"><span class="Apple-converted-space">  </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">    </span>nextLine.textContent = `Next collection: ${formatFull(next.date)}`;</p>
<p class="p1"><span class="Apple-converted-space">    </span>pill.style.display = "inline-flex";</p>
<p class="p1"><span class="Apple-converted-space">    </span>binName.textContent = next.bin;</p>
<p class="p1"><span class="Apple-converted-space">    </span>binDot.style.background = binColours[next.bin] || "gray";</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Helpful note if it's not the usual Thursday</p>
<p class="p1"><span class="Apple-converted-space">    </span>const isThursday = next.date.getDay() === 4;</p>
<p class="p1"><span class="Apple-converted-space">    </span>note.textContent = isThursday ? "Standard Thursday collection." : "Special schedule (not Thursday).";</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>// ====== ACTIONS ======</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>document.getElementById("copy").addEventListener("click", async () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (!next) return;</p>
<p class="p1"><span class="Apple-converted-space">    </span>const text = `Next collection: ${formatFull(next.date)} — ${next.bin}`;</p>
<p class="p1"><span class="Apple-converted-space">    </span>try {</p>
<p class="p1"><span class="Apple-converted-space">      </span>await navigator.clipboard.writeText(text);</p>
<p class="p1"><span class="Apple-converted-space">      </span>alert("Copied ✅");</p>
<p class="p1"><span class="Apple-converted-space">    </span>} catch {</p>
<p class="p1"><span class="Apple-converted-space">      </span>prompt("Copy this:", text);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>document.getElementById("addCal").addEventListener("click", () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (!next) return;</p>
<p class="p1"><span class="Apple-converted-space">    </span>const title = `${next.bin} bin out`;</p>
<p class="p1"><span class="Apple-converted-space">    </span>const ics = makeICS({ title, date: next.date, minutesBefore: 720 }); // 12 hours before</p>
<p class="p1"><span class="Apple-converted-space">    </span>const blob = new Blob([ics], { type: "text/calendar;charset=utf-8" });</p>
<p class="p1"><span class="Apple-converted-space">    </span>const url = URL.createObjectURL(blob);</p>
<p class="p1"><span class="Apple-converted-space">    </span>const a = document.createElement("a");</p>
<p class="p1"><span class="Apple-converted-space">    </span>a.href = url;</p>
<p class="p1"><span class="Apple-converted-space">    </span>a.download = `bin-reminder-${toKey(next.date)}.ics`;</p>
<p class="p1"><span class="Apple-converted-space">    </span>document.body.appendChild(a);</p>
<p class="p1"><span class="Apple-converted-space">    </span>a.click();</p>
<p class="p1"><span class="Apple-converted-space">    </span>a.remove();</p>
<p class="p1"><span class="Apple-converted-space">    </span>setTimeout(() =&gt; URL.revokeObjectURL(url), 1000);</p>
<p class="p1"><span class="Apple-converted-space">  </span>});</p>
<p class="p1">&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
